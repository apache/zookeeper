<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_201) on Fri May 03 05:07:44 PDT 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>QuorumCnxManager (Apache ZooKeeper - Server 3.5.5 API)</title>
<meta name="date" content="2019-05-03">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="QuorumCnxManager (Apache ZooKeeper - Server 3.5.5 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/QuorumCnxManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumBean.html" title="class in org.apache.zookeeper.server.quorum"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.InitialMessage.html" title="class in org.apache.zookeeper.server.quorum"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/zookeeper/server/quorum/QuorumCnxManager.html" target="_top">Frames</a></li>
<li><a href="QuorumCnxManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.zookeeper.server.quorum</div>
<h2 title="Class QuorumCnxManager" class="title">Class QuorumCnxManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.zookeeper.server.quorum.QuorumCnxManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">QuorumCnxManager</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">This class implements a connection manager for leader election using TCP. It
 maintains one connection for every pair of servers. The tricky part is to
 guarantee that there is exactly one connection for every pair of servers that
 are operating correctly and that can communicate over the network.
 
 If two servers try to start a connection concurrently, then the connection
 manager uses a very simple tie-breaking mechanism to decide which connection
 to drop based on the IP addressed of the two parties. 
 
 For every peer, the manager maintains a queue of messages to send. If the
 connection to any particular peer drops, then the sender thread puts the
 message back on the list. As this implementation currently uses a queue
 implementation to maintain messages to send to another peer, we add the
 message to the tail of the queue, thus changing the order of messages.
 Although this is not a problem for the leader election, it could be a problem
 when consolidating peer communication. This is to be verified, though.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.InitialMessage.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.InitialMessage</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Listener.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Listener</a></span></code>
<div class="block">Thread to listen on some port</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Listener.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Listener</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#listener">listener</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#maxBuffer">maxBuffer</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#PROTOCOL_VERSION">PROTOCOL_VERSION</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ArrayBlockingQueue.html?is-external=true" title="class or interface in java.util.concurrent">ArrayBlockingQueue</a>&lt;<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#recvQueue">recvQueue</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#QuorumCnxManager-org.apache.zookeeper.server.quorum.QuorumPeer-long-java.util.Map-org.apache.zookeeper.server.quorum.auth.QuorumAuthServer-org.apache.zookeeper.server.quorum.auth.QuorumAuthLearner-int-boolean-int-boolean-">QuorumCnxManager</a></span>(<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumPeer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer</a>&nbsp;self,
                long&nbsp;mySid,
                <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumPeer.QuorumServer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer.QuorumServer</a>&gt;&nbsp;view,
                <a href="../../../../../org/apache/zookeeper/server/quorum/auth/QuorumAuthServer.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthServer</a>&nbsp;authServer,
                <a href="../../../../../org/apache/zookeeper/server/quorum/auth/QuorumAuthLearner.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthLearner</a>&nbsp;authLearner,
                int&nbsp;socketTimeout,
                boolean&nbsp;listenOnAllIPs,
                int&nbsp;quorumCnxnThreadsSize,
                boolean&nbsp;quorumSaslAuthEnabled)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#addToRecvQueue-org.apache.zookeeper.server.quorum.QuorumCnxManager.Message-">addToRecvQueue</a></span>(<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&nbsp;msg)</code>
<div class="block">Inserts an element in the <a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#recvQueue"><code>recvQueue</code></a>.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#connectAll--">connectAll</a></span>()</code>
<div class="block">Try to establish a connection with each server if one
 doesn't exist.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#connectedToPeer-long-">connectedToPeer</a></span>(long&nbsp;peerSid)</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#getConnectionThreadCount--">getConnectionThreadCount</a></span>()</code>
<div class="block">Return number of connection processing threads.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#getThreadCount--">getThreadCount</a></span>()</code>
<div class="block">Return number of worker threads</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#halt--">halt</a></span>()</code>
<div class="block">Flag that it is time to wrap up all activities and interrupt the listener.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#initiateConnection-java.net.Socket-java.lang.Long-">initiateConnection</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock,
                  <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;sid)</code>
<div class="block">If this server has initiated the connection, then it gives up on the
 connection if it loses challenge.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#initiateConnectionAsync-java.net.Socket-java.lang.Long-">initiateConnectionAsync</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock,
                       <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;sid)</code>
<div class="block">Server will initiate the connection request to its peer server
 asynchronously via separate connection thread.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#pollRecvQueue-long-java.util.concurrent.TimeUnit-">pollRecvQueue</a></span>(long&nbsp;timeout,
             <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)</code>
<div class="block">Retrieves and removes a message at the head of this queue,
 waiting up to the specified wait time if necessary for an element to
 become available.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#receiveConnection-java.net.Socket-">receiveConnection</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock)</code>
<div class="block">If this server receives a connection request, then it gives up on the new
 connection if it wins.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#receiveConnectionAsync-java.net.Socket-">receiveConnectionAsync</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock)</code>
<div class="block">Server receives a connection request and handles it asynchronously via
 separate thread.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#softHalt--">softHalt</a></span>()</code>
<div class="block">A soft halt simply finishes workers.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#testInitiateConnection-long-">testInitiateConnection</a></span>(long&nbsp;sid)</code>
<div class="block">Invokes initiateConnection for testing purposes</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#toSend-java.lang.Long-java.nio.ByteBuffer-">toSend</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;sid,
      <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;b)</code>
<div class="block">Processes invoke this message to queue a message to send.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="PROTOCOL_VERSION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROTOCOL_VERSION</h4>
<pre>public static final&nbsp;long PROTOCOL_VERSION</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.zookeeper.server.quorum.QuorumCnxManager.PROTOCOL_VERSION">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="maxBuffer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maxBuffer</h4>
<pre>public static final&nbsp;int maxBuffer</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.zookeeper.server.quorum.QuorumCnxManager.maxBuffer">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="recvQueue">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recvQueue</h4>
<pre>public final&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ArrayBlockingQueue.html?is-external=true" title="class or interface in java.util.concurrent">ArrayBlockingQueue</a>&lt;<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&gt; recvQueue</pre>
</li>
</ul>
<a name="listener">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>listener</h4>
<pre>public final&nbsp;<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Listener.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Listener</a> listener</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="QuorumCnxManager-org.apache.zookeeper.server.quorum.QuorumPeer-long-java.util.Map-org.apache.zookeeper.server.quorum.auth.QuorumAuthServer-org.apache.zookeeper.server.quorum.auth.QuorumAuthLearner-int-boolean-int-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>QuorumCnxManager</h4>
<pre>public&nbsp;QuorumCnxManager(<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumPeer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer</a>&nbsp;self,
                        long&nbsp;mySid,
                        <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>,<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumPeer.QuorumServer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer.QuorumServer</a>&gt;&nbsp;view,
                        <a href="../../../../../org/apache/zookeeper/server/quorum/auth/QuorumAuthServer.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthServer</a>&nbsp;authServer,
                        <a href="../../../../../org/apache/zookeeper/server/quorum/auth/QuorumAuthLearner.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthLearner</a>&nbsp;authLearner,
                        int&nbsp;socketTimeout,
                        boolean&nbsp;listenOnAllIPs,
                        int&nbsp;quorumCnxnThreadsSize,
                        boolean&nbsp;quorumSaslAuthEnabled)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="testInitiateConnection-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>testInitiateConnection</h4>
<pre>public&nbsp;void&nbsp;testInitiateConnection(long&nbsp;sid)
                            throws <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></pre>
<div class="block">Invokes initiateConnection for testing purposes</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sid</code> - </dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></code></dd>
</dl>
</li>
</ul>
<a name="initiateConnection-java.net.Socket-java.lang.Long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initiateConnection</h4>
<pre>public&nbsp;void&nbsp;initiateConnection(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock,
                               <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;sid)</pre>
<div class="block">If this server has initiated the connection, then it gives up on the
 connection if it loses challenge. Otherwise, it keeps the connection.</div>
</li>
</ul>
<a name="initiateConnectionAsync-java.net.Socket-java.lang.Long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initiateConnectionAsync</h4>
<pre>public&nbsp;void&nbsp;initiateConnectionAsync(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock,
                                    <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;sid)</pre>
<div class="block">Server will initiate the connection request to its peer server
 asynchronously via separate connection thread.</div>
</li>
</ul>
<a name="receiveConnection-java.net.Socket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>receiveConnection</h4>
<pre>public&nbsp;void&nbsp;receiveConnection(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock)</pre>
<div class="block">If this server receives a connection request, then it gives up on the new
 connection if it wins. Notice that it checks whether it has a connection
 to this server already or not. If it does, then it sends the smallest
 possible long value to lose the challenge.</div>
</li>
</ul>
<a name="receiveConnectionAsync-java.net.Socket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>receiveConnectionAsync</h4>
<pre>public&nbsp;void&nbsp;receiveConnectionAsync(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net">Socket</a>&nbsp;sock)</pre>
<div class="block">Server receives a connection request and handles it asynchronously via
 separate thread.</div>
</li>
</ul>
<a name="toSend-java.lang.Long-java.nio.ByteBuffer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toSend</h4>
<pre>public&nbsp;void&nbsp;toSend(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;sid,
                   <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;b)</pre>
<div class="block">Processes invoke this message to queue a message to send. Currently, 
 only leader election uses it.</div>
</li>
</ul>
<a name="connectAll--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connectAll</h4>
<pre>public&nbsp;void&nbsp;connectAll()</pre>
<div class="block">Try to establish a connection with each server if one
 doesn't exist.</div>
</li>
</ul>
<a name="halt--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>halt</h4>
<pre>public&nbsp;void&nbsp;halt()</pre>
<div class="block">Flag that it is time to wrap up all activities and interrupt the listener.</div>
</li>
</ul>
<a name="softHalt--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>softHalt</h4>
<pre>public&nbsp;void&nbsp;softHalt()</pre>
<div class="block">A soft halt simply finishes workers.</div>
</li>
</ul>
<a name="getThreadCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getThreadCount</h4>
<pre>public&nbsp;long&nbsp;getThreadCount()</pre>
<div class="block">Return number of worker threads</div>
</li>
</ul>
<a name="getConnectionThreadCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConnectionThreadCount</h4>
<pre>public&nbsp;long&nbsp;getConnectionThreadCount()</pre>
<div class="block">Return number of connection processing threads.</div>
</li>
</ul>
<a name="addToRecvQueue-org.apache.zookeeper.server.quorum.QuorumCnxManager.Message-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addToRecvQueue</h4>
<pre>public&nbsp;void&nbsp;addToRecvQueue(<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&nbsp;msg)</pre>
<div class="block">Inserts an element in the <a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.html#recvQueue"><code>recvQueue</code></a>. If the Queue is full, this
 methods removes an element from the head of the Queue and then inserts
 the element at the tail of the queue.

 This method is synchronized to achieve fairness between two threads that
 are trying to insert an element in the queue. Each thread checks if the
 queue is full, then removes the element at the head of the queue, and
 then inserts an element at the tail. This three-step process is done to
 prevent a thread from blocking while inserting an element in the queue.
 If we do not synchronize the call to this method, then a thread can grab
 a slot in the queue created by the second thread. This can cause the call
 to insert by the second thread to fail.
 Note that synchronizing this method does not block another thread
 from polling the queue since that synchronization is provided by the
 queue itself.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>msg</code> - Reference to the message to be inserted in the queue</dd>
</dl>
</li>
</ul>
<a name="pollRecvQueue-long-java.util.concurrent.TimeUnit-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pollRecvQueue</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&nbsp;pollRecvQueue(long&nbsp;timeout,
                                              <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)
                                       throws <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Retrieves and removes a message at the head of this queue,
 waiting up to the specified wait time if necessary for an element to
 become available.

 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ArrayBlockingQueue.html?is-external=true#poll-long-java.util.concurrent.TimeUnit-" title="class or interface in java.util.concurrent"><code>ArrayBlockingQueue.poll(long, java.util.concurrent.TimeUnit)</code></a></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd>
</dl>
</li>
</ul>
<a name="connectedToPeer-long-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>connectedToPeer</h4>
<pre>public&nbsp;boolean&nbsp;connectedToPeer(long&nbsp;peerSid)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/QuorumCnxManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumBean.html" title="class in org.apache.zookeeper.server.quorum"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/zookeeper/server/quorum/QuorumCnxManager.InitialMessage.html" title="class in org.apache.zookeeper.server.quorum"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/zookeeper/server/quorum/QuorumCnxManager.html" target="_top">Frames</a></li>
<li><a href="QuorumCnxManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2008&#x2013;2019 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</body>
</html>
