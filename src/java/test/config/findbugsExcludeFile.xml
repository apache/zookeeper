<FindBugsFilter>
  <!-- Allow command line utilities, which follow pattern *Main.java, to call
       system exit -->
  <Match>
    <Class name="~org\.apache\.zookeeper\..*Main" />
    <Bug pattern="DM_EXIT" />
  </Match>

  <!-- This is too complicated to resolve/ingrained into the architecture
       In particular we want to make sure we exit if this occurs
       Also notice logged as fatal error -->
  <Match>
    <Class name="org.apache.zookeeper.server.SyncRequestProcessor" />
    <Method name="run" />
    <Bug pattern="DM_EXIT" />
  </Match>

  <!-- In particular we want to make sure we exit if this occurs, unrecoverable.
       Also notice logged as fatal error -->
  <Match>
    <Class name="org.apache.zookeeper.server.ZooKeeperServer" />
    <Method name="takeSnapshot" />
    <Bug pattern="DM_EXIT" />
  </Match>


  <!-- We want to catch all exceptions and cleanup, regardless of source
       (incl runtime) -->
  <Match>
    <Class name="org.apache.zookeeper.ClientCnxn$SendThread" />
    <Method name="run" />
    <Bug pattern="REC_CATCH_EXCEPTION" />
  </Match>


   <!-- If we cannot open a socket to elect a leader, then we should
            simply exit -->
   <Match>
     <Class name="org.apache.zookeeper.server.quorum.LeaderElection" />
       <Method name="lookForLeader" />
       <Bug pattern="DM_EXIT" />
   </Match>

   <!-- Committing out of order is an unrecoverable error, so we should
              really exit  -->
   <Match>
     <Class name="org.apache.zookeeper.server.quorum.FollowerZooKeeperServer" />
       <Method name="commit" />
       <Bug pattern="DM_EXIT" />
     </Match>

   <!-- Two unrecoverable errors while following the leader  -->
   <Match>
     <Class name="org.apache.zookeeper.server.quorum.Follower" />
       <Method name="followLeader" />
       <Bug pattern="DM_EXIT" />
   </Match>

  <Match>
    <Package name="org.apache.jute.compiler.generated" />
  </Match>

</FindBugsFilter>
